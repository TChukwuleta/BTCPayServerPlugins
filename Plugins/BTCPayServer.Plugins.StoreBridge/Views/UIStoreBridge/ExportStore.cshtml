@using BTCPayServer.Abstractions.Contracts
@using BTCPayServer.Abstractions.Extensions
@using BTCPayServer.Abstractions.Models
@using BTCPayServer.Plugins.StoreBridge.ViewModels
@inject IScopeProvider ScopeProvider
@model ExportViewModel
@{
    Layout = "_Layout";
    var storeId = ScopeProvider.GetCurrentStoreId();
    ViewData.SetLayoutModel(new LayoutModel("StoreBridge-Export", "Shopify Bridge - Export") { ActiveCategory = "StoreBridge" });
}
<div class="sticky-header">
    <h2 text-translate="true">@ViewData["Title"]</h2>
    <div class="d-flex gap-3 mt-3 mt-sm-0">
        <button type="submit" form="exportForm" class="btn btn-primary">
            <i class="fa fa-download me-2"></i>
            Download Store Export
        </button>
    </div>
</div>
<partial name="_StatusMessage" />

<form method="post" asp-action="ExportStore" id="exportForm">
    <input type="hidden" asp-for="StoreId" />
    <p class="mb-4" style="font-size: 1.1rem;">Uncheck any items you don't want to include in the export file</p>

    <div class="mb-4">
        @foreach (var option in ExportViewModel.AllOptions)
        {
            var metadata = ExportViewModel.OptionMetadata[option];
            var isChecked = Model.IsSelected(option);

            <div class="form-check mb-3">
                <input class="form-check-input"
                       type="checkbox"
                       name="SelectedOptions"
                       value="@option"
                       id="export@option"
                       checked="@isChecked"
                       style="width: 1.2em; height: 1.2em;">
                <label class="form-check-label" for="export@option" style="font-size: 1.1rem; padding-left: 0.5rem;">
                    <strong>@metadata.Title</strong>
                    <small class="d-block text-muted">@metadata.Description</small>
                </label>
            </div>
        }
    </div>

    <div class="alert alert-warning mb-4" role="alert">
        <i class="fa fa-exclamation-triangle me-2"></i>
        The export file contains sensitive information including webhook secrets and wallet xpubs. Store it securely and only share it with trusted parties. Private keys, seeds, lightning node credentials, and passwords are NEVER exported for security reasons.
    </div>
</form>